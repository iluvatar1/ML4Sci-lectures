
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3. Pandas for data cleaning and analysis &#8212; Introduction to Machine Learning for Science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-examples.css?v=e236af4b" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-shadow.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-punk.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-noir.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-light.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-borderless.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/micromodal.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles.css?v=76e7d31e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../../_static/tabs.js?v=3ee01567"></script>
    <script src="../../_static/js/hoverxref.js"></script>
    <script src="../../_static/js/tooltipster.bundle.min.js"></script>
    <script src="../../_static/js/micromodal.min.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-JMZ8EV2JDJ"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-JMZ8EV2JDJ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-JMZ8EV2JDJ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/02-LimpiezayPrepDatos/DataCleaning';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4. An Introduction to Principal Component Analysis (PCA)" href="../03-PCA/Intro-PCA.html" />
    <link rel="prev" title="2. A fast introduction to Machine Learning" href="../00-TALK-IntroML/IntroMachineLearning.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../README.html">
  
  
  
  
  
  
    <p class="title logo__title">Introduction to Machine Learning for Science</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    Introduction to Machine Learning for Science
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00-IntroductionCourseML/IntroCourse-MachineLearning.html">1. Introduction to the course and to Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00-TALK-IntroML/IntroMachineLearning.html">2. A fast introduction to Machine Learning</a></li>





<li class="toctree-l1 current active"><a class="current reference internal" href="#">3. Pandas for data cleaning and analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unsupervised learning I</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../03-PCA/Intro-PCA.html">4. An Introduction to Principal Component Analysis (PCA)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Supervised learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../04-LinearRegression/LinearRegression.html">5. Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-LogisticRegression/LogisticRegression.html">6. An Introduction to Logistic Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06-SVM/SVM.html">7. Support Vector Machines</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to Neural Networks</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../07-IntroNeuralNetworks/NeuralNetworks-BasicConcepts.html">8. Neural Networks Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07-IntroNeuralNetworks/DeepLearning.html">9. An Introduction to Deep Learning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01-reviewPython/PythonReview.html">10. Python Review:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-reviewPython/01-IntroProgrammingPython.html">11. Python Programming (very fast) Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-reviewPython/02-IntroProgrammingPython-DataStructs.html">12. Intro Python II: python data structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-reviewPython/pandas-intro.html">13. Pandas Introduction</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/iluvatar1/ML4Sci-lectures/master?urlpath=lab/tree/lectures/02-LimpiezayPrepDatos/DataCleaning.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/iluvatar1/ML4Sci-lectures/blob/master/lectures/02-LimpiezayPrepDatos/DataCleaning.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/iluvatar1/ML4Sci-lectures" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/iluvatar1/ML4Sci-lectures/issues/new?title=Issue%20on%20page%20%2Flectures/02-LimpiezayPrepDatos/DataCleaning.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/lectures/02-LimpiezayPrepDatos/DataCleaning.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Pandas for data cleaning and analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-dataframe">3.1. The Dataframe</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-vs-polars">3.2. Pandas vs. Polars</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#polars-syntax-example">3.2.1. Polars Syntax Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applied-pandas-tutorial">3.3. Applied pandas tutorial</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-the-data">3.3.1. Getting the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-missing-values">3.3.2. Handling missing values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correcting-cosmic-anomalies-outliers">3.3.3. Correcting Cosmic Anomalies (Outliers)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-analysis">3.3.4. More analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-about-pandas">3.3.5. More about pandas</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pandas-for-data-cleaning-and-analysis">
<h1><span class="section-number">3. </span>Pandas for data cleaning and analysis<a class="headerlink" href="#pandas-for-data-cleaning-and-analysis" title="Link to this heading">#</a></h1>
<p>Pandas has two main data structures:</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">Series</span></code></strong>: A one-dimensional labeled array, like a single column of data.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></strong>: A two-dimensional labeled data structure with columns of potentially different types, similar to a spreadsheet or SQL table.</p></li>
</ul>
<section id="the-dataframe">
<h2><span class="section-number">3.1. </span>The Dataframe<a class="headerlink" href="#the-dataframe" title="Link to this heading">#</a></h2>
<p>The dataframe is the most important object inside pandas. It allows to represent, access, process, etc multi-dimensional data.</p>
<p><img alt="Pandas dataframe" src="https://www.w3resource.com/w3r_images/pandas-data-structure.svg" /></p>
<p>Source: <a class="reference external" href="https://www.w3resource.com/python-exercises/pandas/index.php">https://www.w3resource.com/python-exercises/pandas/index.php</a></p>
<p><img alt="Pandas dataframe example" src="https://miro.medium.com/max/1400/1*ZSehcrMtBWN7_qCWq_HiSg.png" /></p>
<p>Source: <a class="reference external" href="https://medium.com/dunder-data/selecting-subsets-of-data-in-pandas-6fcd0170be9c">https://medium.com/dunder-data/selecting-subsets-of-data-in-pandas-6fcd0170be9c</a></p>
<p>You can initialize a dataframe in several ways. For example, you can use a dictionary or a nested list. Or you can read from a file, either local or online.
For example, you can do something like</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">909976</span><span class="p">,</span> <span class="s2">&quot;Sweden&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">8615246</span><span class="p">,</span> <span class="s2">&quot;United Kingdom&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">2872086</span><span class="p">,</span> <span class="s2">&quot;Italy&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">2273305</span><span class="p">,</span> <span class="s2">&quot;France&quot;</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">344444</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>909976</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8615246</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2872086</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2273305</td>
      <td>France</td>
    </tr>
    <tr>
      <th>4</th>
      <td>344444</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>909976</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8615246</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2872086</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2273305</td>
      <td>France</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;Unknown&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>909976</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8615246</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2872086</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2273305</td>
      <td>France</td>
    </tr>
    <tr>
      <th>4</th>
      <td>344444</td>
      <td>Unknown</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>909976</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8615246</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2872086</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2273305</td>
      <td>France</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Stockholm&quot;</span><span class="p">,</span> <span class="s2">&quot;London&quot;</span><span class="p">,</span> <span class="s2">&quot;Rome&quot;</span><span class="p">,</span> <span class="s2">&quot;Paris&quot;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Population&quot;</span><span class="p">,</span> <span class="s2">&quot;State&quot;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Population</th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Stockholm</th>
      <td>909976</td>
      <td>Sweden</td>
    </tr>
    <tr>
      <th>London</th>
      <td>8615246</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>Rome</th>
      <td>2872086</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>Paris</th>
      <td>2273305</td>
      <td>France</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pandas-vs-polars">
<h2><span class="section-number">3.2. </span>Pandas vs. Polars<a class="headerlink" href="#pandas-vs-polars" title="Link to this heading">#</a></h2>
<p>Polars is a newer, extremely fast DataFrame library built in Rust. It’s gaining popularity for its performance, especially on large datasets.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Pandas</p></th>
<th class="head"><p>Polars</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Backend</strong></p></td>
<td><p>Python/NumPy (partially C)</p></td>
<td><p>Rust (built on Apache Arrow)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Performance</strong></p></td>
<td><p>Slower, especially on large data.</p></td>
<td><p>Significantly faster (5-100x) due to parallelism and query optimization.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Execution Model</strong></p></td>
<td><p>Eager (executes line-by-line)</p></td>
<td><p>Supports both Eager and Lazy execution (optimizes the whole query before running)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Memory Usage</strong></p></td>
<td><p>Higher memory footprint.</p></td>
<td><p>More memory efficient.</p></td>
</tr>
<tr class="row-even"><td><p><strong>API</strong></p></td>
<td><p>Very flexible, but can be inconsistent (e.g., <code class="docutils literal notranslate"><span class="pre">inplace</span></code>).</p></td>
<td><p>More consistent and expressive, encourages method chaining.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Ecosystem</strong></p></td>
<td><p>Mature and extensive. Integrates with almost every data science library (scikit-learn, Matplotlib, etc.).</p></td>
<td><p>Growing, but less integrated with the broader ML ecosystem.</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>When to choose which?</strong></p>
<ul class="simple">
<li><p><strong>Pandas</strong>: Excellent for data exploration, smaller datasets (up to a few GB), and projects that need deep integration with libraries like scikit-learn.</p></li>
<li><p><strong>Polars</strong>: Ideal for large datasets, performance-critical data transformations, and building data pipelines where speed and memory are key.</p></li>
</ul>
<section id="polars-syntax-example">
<h3><span class="section-number">3.2.1. </span>Polars Syntax Example<a class="headerlink" href="#polars-syntax-example" title="Link to this heading">#</a></h3>
<p>Notice the similarity, but also the use of expressions (<code class="docutils literal notranslate"><span class="pre">pl.col()</span></code>).</p>
<p><strong>Simple exercise</strong>
Complete the demo (find a data source) and create a script with inline dependencies.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>

<span class="c1"># Same data in a Polars DataFrame</span>
<span class="n">df_pl</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># The same aggregation, but using the Polars expression API</span>
<span class="n">polar_stats</span> <span class="o">=</span> <span class="n">df_pl</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s1">&#39;Experiment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;Measurement&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">),</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="s1">&#39;Measurement&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;std&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">polar_stats</span><span class="p">)</span>
</pre></div>
</div>
<div class="docutils">
</div>
</section>
</section>
<section id="applied-pandas-tutorial">
<h2><span class="section-number">3.3. </span>Applied pandas tutorial<a class="headerlink" href="#applied-pandas-tutorial" title="Link to this heading">#</a></h2>
<p>In this tutorial we will explore a real data escenario to look for exoplanets! We will use real data and <code class="docutils literal notranslate"><span class="pre">pandas</span></code> to clean it and get some useful info. The main goal is to be able to answer questions like:</p>
<ul class="simple">
<li><p>What is the most common method for discovering exoplanets?</p></li>
<li><p>What is the average size of a planet discovered in the last decade?</p></li>
<li><p>Is there a relationship between a star’s temperature and the mass of its planets?</p></li>
</ul>
<p>But when you first look at the data, you realize it’s not that simple. There are gaps, inconsistencies, and errors. This is where we need to clean the data.</p>
<section id="getting-the-data">
<h3><span class="section-number">3.3.1. </span>Getting the data<a class="headerlink" href="#getting-the-data" title="Link to this heading">#</a></h3>
<p>First, let’s pull the data directly from the NASA Exoplanet Archive. This is real, live data! <a class="reference external" href="https://exoplanetarchive.ipac.caltech.edu/docs/data.html">https://exoplanetarchive.ipac.caltech.edu/docs/data.html</a></p>
<p>The columns we are requesting are:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pl_name: Planet Name

hostname: Host Star Name

discoverymethod: How the planet was found

pl_orbper: Orbital Period (days)

pl_rade: Planet Radius (Earth radii)

pl_bmasse: Planet Mass (Earth masses)

st_teff: Star&#39;s Effective Temperature (Kelvin)

st_rad: Star&#39;s Radius (Solar radii)

st_mass: Star&#39;s Mass (Solar masses)

disc_year: Discovery Year
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span> <span class="c1"># We&#39;ll need numpy for more advanced NaN handling</span>

<span class="c1"># The official URL from the NASA Exoplanet Archive</span>
<span class="c1"># https://exoplanetarchive.ipac.caltech.edu/docs/data.html</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://exoplanetarchive.ipac.caltech.edu/TAP/sync?query=select+pl_name,hostname,discoverymethod,pl_orbper,pl_rade,pl_bmasse,st_teff,st_rad,st_mass,disc_year+from+ps&amp;format=csv&quot;</span>

<span class="c1"># Load the data into a pandas DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="c1"># go and read the manual</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Our Raw Exoplanet Data (First 5 Rows):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Our Raw Exoplanet Data (First 5 Rows):
       pl_name   hostname  discoverymethod     pl_orbper  pl_rade  pl_bmasse  \
0    HR 8799 d    HR 8799          Imaging  37000.000000    13.00   3000.000   
1  HD 156279 b  HD 156279  Radial Velocity    131.050000      NaN   3086.000   
2     GJ 832 b     GJ 832  Radial Velocity   3507.000000      NaN    197.046   
3    GJ 1214 b    GJ 1214          Transit      1.580405     2.27      6.430   
4   HD 24040 b   HD 24040  Radial Velocity   3668.000000      NaN   1274.440   

   st_teff    st_rad   st_mass  disc_year  
0      NaN       NaN  1.500000     2008.0  
1   5453.0       NaN  0.930000     2011.0  
2      NaN  0.441557  0.437474     2008.0  
3      NaN  0.210000  0.157000     2009.0  
4      NaN       NaN  1.180000     2006.0  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Mission Critical Info ---&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Mission Critical Info ---
&lt;class &#39;pandas.DataFrame&#39;&gt;
RangeIndex: 39282 entries, 0 to 39281
Data columns (total 10 columns):
 #   Column           Non-Null Count  Dtype  
---  ------           --------------  -----  
 0   pl_name          39282 non-null  str    
 1   hostname         39282 non-null  str    
 2   discoverymethod  39282 non-null  str    
 3   pl_orbper        35979 non-null  float64
 4   pl_rade          27088 non-null  float64
 5   pl_bmasse        7144 non-null   float64
 6   st_teff          35780 non-null  float64
 7   st_rad           36015 non-null  float64
 8   st_mass          33163 non-null  float64
 9   disc_year        39280 non-null  float64
dtypes: float64(7), str(3)
memory usage: 3.0 MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pl_orbper</th>
      <th>pl_rade</th>
      <th>pl_bmasse</th>
      <th>st_teff</th>
      <th>st_rad</th>
      <th>st_mass</th>
      <th>disc_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3.597900e+04</td>
      <td>27088.000000</td>
      <td>7144.000000</td>
      <td>35780.000000</td>
      <td>36015.000000</td>
      <td>33163.000000</td>
      <td>39280.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.215855e+04</td>
      <td>5.460234</td>
      <td>742.825474</td>
      <td>5461.339677</td>
      <td>1.152090</td>
      <td>0.943310</td>
      <td>2015.543457</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.120575e+06</td>
      <td>71.802543</td>
      <td>1561.152316</td>
      <td>994.024085</td>
      <td>1.780882</td>
      <td>0.324111</td>
      <td>4.014510</td>
    </tr>
    <tr>
      <th>min</th>
      <td>9.070629e-02</td>
      <td>0.270000</td>
      <td>0.015000</td>
      <td>415.000000</td>
      <td>0.012300</td>
      <td>0.003100</td>
      <td>1992.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>4.385340e+00</td>
      <td>1.550000</td>
      <td>13.500000</td>
      <td>5098.000000</td>
      <td>0.787000</td>
      <td>0.810000</td>
      <td>2014.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.033111e+01</td>
      <td>2.300000</td>
      <td>192.302490</td>
      <td>5613.000000</td>
      <td>0.951815</td>
      <td>0.959000</td>
      <td>2016.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.662942e+01</td>
      <td>3.280000</td>
      <td>687.598754</td>
      <td>5951.000000</td>
      <td>1.214000</td>
      <td>1.071000</td>
      <td>2016.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.020000e+08</td>
      <td>4282.980000</td>
      <td>25426.400000</td>
      <td>57000.000000</td>
      <td>88.475000</td>
      <td>23.560000</td>
      <td>2026.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pl_name</th>
      <th>hostname</th>
      <th>discoverymethod</th>
      <th>pl_orbper</th>
      <th>pl_rade</th>
      <th>pl_bmasse</th>
      <th>st_teff</th>
      <th>st_rad</th>
      <th>st_mass</th>
      <th>disc_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>39277</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>39278</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>39279</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>39280</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>39281</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>39282 rows × 10 columns</p>
</div></div></div>
</div>
<p>Analyze the output:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Total</span> <span class="pre">entries</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Non-null</span> <span class="pre">count</span></code> : Significant missing data problem</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Dtype</span></code>: getting <code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code> is good (where it makes sense). If all were objects, that would signal hidden text or errors.</p></li>
</ul>
<p>Before doing any chance, let’s quantify the missing data.</p>
<div class="exercise admonition" id="lectures/02-LimpiezayPrepDatos/DataCleaning-exercise-0">

<p class="admonition-title"><span class="caption-number">Exercise 3.1 </span> (Quantifying the void)</p>
<section id="exercise-content">
<p>Use a single pandas command to calculate the total number of missing values for each column. What column has the most missing data? does it make sense (measuring mass or radius can be much harder that just measuring the presence)</p>
</section>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
<p>You can also access columns or groups of columns like</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;pl_orbper&#39;</span><span class="p">,</span> <span class="s1">&#39;pl_rade&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pl_orbper</th>
      <th>pl_rade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>37000.000000</td>
      <td>13.00000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>131.050000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3507.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.580405</td>
      <td>2.27000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3668.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>39277</th>
      <td>7.126874</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>39278</th>
      <td>10120.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>39279</th>
      <td>10090.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>39280</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>39281</th>
      <td>NaN</td>
      <td>17.37392</td>
    </tr>
  </tbody>
</table>
<p>39282 rows × 2 columns</p>
</div></div></div>
</div>
</section>
<section id="handling-missing-values">
<h3><span class="section-number">3.3.2. </span>Handling missing values<a class="headerlink" href="#handling-missing-values" title="Link to this heading">#</a></h3>
<p>Missing data will affect your analysis. To handle it, you need to think <em>why</em> the data is missing, and <em>how much</em> data is missing.</p>
<p>Let’s focus on the key planetary characteristics: pl_orbper, pl_rade, and pl_bmasse.</p>
<p>Dropping all rows with any missing data (<code class="docutils literal notranslate"><span class="pre">df.dropna()</span></code>) would be a disaster: we’d lose a huge portion of our catalog! A better approach is imputation: filling the gaps with a sensible calculated value.</p>
<p>The <em>median</em> is often a better choice for imputation than the <em>mean</em> for astronomical data, as it’s less sensitive to extreme outliers (e.g., a planet with a gigantic radius or a very long orbital period). Check also <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html">https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html</a> .</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># It&#39;s good practice to work on a copy</span>
<span class="n">df_cleaned</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Calculate the median for the columns we want to fill</span>
<span class="c1"># We&#39;ll calculate them from the original data before we start changing it</span>
<span class="n">median_radius</span> <span class="o">=</span> <span class="n">df_cleaned</span><span class="p">[</span><span class="s1">&#39;pl_rade&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">median_mass</span> <span class="o">=</span> <span class="n">df_cleaned</span><span class="p">[</span><span class="s1">&#39;pl_bmasse&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="n">median_orb_period</span> <span class="o">=</span> <span class="n">df_cleaned</span><span class="p">[</span><span class="s1">&#39;pl_orbper&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="c1"># Impute the missing values using the calculated medians</span>
<span class="c1"># df_cleaned[&#39;pl_rade&#39;].fillna(median_radius, inplace=True) # Avoid inplace=True in a copy object</span>
<span class="n">df_cleaned</span><span class="p">[</span><span class="s1">&#39;pl_rade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_cleaned</span><span class="p">[</span><span class="s1">&#39;pl_rade&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">median_radius</span><span class="p">)</span>
<span class="n">df_cleaned</span><span class="p">[</span><span class="s1">&#39;pl_bmasse&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_cleaned</span><span class="p">[</span><span class="s1">&#39;pl_bmasse&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">median_mass</span><span class="p">)</span>
<span class="n">df_cleaned</span><span class="p">[</span><span class="s1">&#39;pl_orbper&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_cleaned</span><span class="p">[</span><span class="s1">&#39;pl_orbper&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">median_orb_period</span><span class="p">)</span>
<span class="c1"># # or better use</span>
<span class="c1"># df_cleaned.fillna({</span>
<span class="c1">#     &#39;pl_rade&#39;: df_cleaned[&#39;pl_rade&#39;].median(),</span>
<span class="c1">#     &#39;pl_bmasse&#39;: df_cleaned[&#39;pl_bmasse&#39;].median(),</span>
<span class="c1">#     &#39;pl_orbper&#39;: df_cleaned[&#39;pl_orbper&#39;].median()</span>
<span class="c1"># }, inplace=True)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Missing Values After Imputation ---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_cleaned</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Missing Values After Imputation ---
pl_name               0
hostname              0
discoverymethod       0
pl_orbper             0
pl_rade               0
pl_bmasse             0
st_teff            3502
st_rad             3267
st_mass            6119
disc_year             2
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Now our core planet columns are filled! We still have missing data in the star properties (st_teff, st_rad, st_mass), but we can leave them for now, as our analysis might not always require them.</p>
<div class="exercise admonition" id="lectures/02-LimpiezayPrepDatos/DataCleaning-exercise-1">

<p class="admonition-title"><span class="caption-number">Exercise 3.2 </span> (Missing star data)</p>
<section id="exercise-content">
<ol class="arabic simple">
<li><p>Choose one of the star-related columns with missing data (st_teff, st_rad, or st_mass).</p></li>
<li><p>Calculate the median for that column.</p></li>
<li><p>Impute (fill) the missing values in that column using its median.</p></li>
<li><p>Verify your work by checking the isnull().sum() count for that column again. It should be zero!</p></li>
</ol>
</section>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="correcting-cosmic-anomalies-outliers">
<h3><span class="section-number">3.3.3. </span>Correcting Cosmic Anomalies (Outliers)<a class="headerlink" href="#correcting-cosmic-anomalies-outliers" title="Link to this heading">#</a></h3>
<p>Outliers are extreme values that can skew our understanding. They could be real, fascinating discoveries (like a planet with a massive orbit) or simple data entry errors. Visualizing the data is the best way to spot them.</p>
<p>A <strong>box plot</strong> is a powerful tool for outlier detection.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="c1"># Set a nice style for our plots</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

<span class="c1"># Let&#39;s visualize the distribution of Planet Radius</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_cleaned</span><span class="p">[</span><span class="s1">&#39;pl_rade&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Exoplanet Radii (in Earth Radii)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span> <span class="c1"># Log scale is often essential for astronomical data!</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e00f5bc0373f56eabddf5da2eb5c119fa33a69f5567064a1e84e94b36128e1bd.png" src="../../_images/e00f5bc0373f56eabddf5da2eb5c119fa33a69f5567064a1e84e94b36128e1bd.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot showing data</span>
<span class="c1"># Maybe use stripplot, swarmplot, or even a violin plot</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;darkgrid&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># First the boxplot</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_cleaned</span><span class="p">[</span><span class="s1">&#39;pl_rade&#39;</span><span class="p">])</span>

<span class="c1"># Overlay the data as scatter (stripplot)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_cleaned</span><span class="p">[</span><span class="s1">&#39;pl_rade&#39;</span><span class="p">],</span> 
              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> 
              <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>   <span class="c1"># transparency</span>
              <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>      <span class="c1"># point size</span>
              <span class="n">jitter</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># adds random jitter to avoid overlap</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Exoplanet Radii (in Earth Radii)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;pl_rade&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9640c2c052f3814685660ec644b9dbd17a97a9dda987ae8424aeb0225057a970.png" src="../../_images/9640c2c052f3814685660ec644b9dbd17a97a9dda987ae8424aeb0225057a970.png" />
</div>
</div>
<p>Notice that the box plot shows many points far to the right. These are planets with very large radii. A log scale helps, but we can see that most planets are clustered in a smaller range. Let’s say, for a specific analysis, we want to focus only on planets that are somewhat similar to Earth, and we consider anything over 20 Earth radii to be a “super-giant” that we want to handle separately.</p>
<p>This is not about deleting data, but about filtering it for a specific analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># How many planets are larger than 20 Earth radii?</span>
<span class="n">super_giants</span> <span class="o">=</span> <span class="n">df_cleaned</span><span class="p">[</span><span class="n">df_cleaned</span><span class="p">[</span><span class="s1">&#39;pl_rade&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">]</span> <span class="c1"># you can use any other condition</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There are </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">super_giants</span><span class="p">)</span><span class="si">}</span><span class="s2"> planets with a radius greater than 20 Earths.&quot;</span><span class="p">)</span>

<span class="c1"># For our analysis, let&#39;s create a new DataFrame without these giants</span>
<span class="n">df_filtered</span> <span class="o">=</span> <span class="n">df_cleaned</span><span class="p">[</span><span class="n">df_cleaned</span><span class="p">[</span><span class="s1">&#39;pl_rade&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Original DataFrame size: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_cleaned</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Filtered DataFrame size: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df_filtered</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are 215 planets with a radius greater than 20 Earths.

Original DataFrame size: 39282
Filtered DataFrame size: 39067
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="c1"># Set a nice style for our plots</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

<span class="c1"># Let&#39;s visualize the distribution of Planet Radius</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_filtered</span><span class="p">[</span><span class="s1">&#39;pl_rade&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Exoplanet Radii (in Earth Radii) - filtered&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span> <span class="c1"># Log scale is often essential for astronomical data!</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b1bbf2120f7d685146ef112109b42644991b1e641833b0999cc51dc00f83acae.png" src="../../_images/b1bbf2120f7d685146ef112109b42644991b1e641833b0999cc51dc00f83acae.png" />
</div>
</div>
<div class="exercise admonition" id="lectures/02-LimpiezayPrepDatos/DataCleaning-exercise-2">

<p class="admonition-title"><span class="caption-number">Exercise 3.3 </span> (Explain this command)</p>
<section id="exercise-content">
</section>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Explain this syntax</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">df_cleaned</span><span class="p">[</span><span class="n">df_cleaned</span><span class="p">[</span><span class="s1">&#39;pl_rade&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">110</span><span class="p">]</span> <span class="c1"># access specific rows</span>
<span class="n">tmp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pl_name</th>
      <th>hostname</th>
      <th>discoverymethod</th>
      <th>pl_orbper</th>
      <th>pl_rade</th>
      <th>pl_bmasse</th>
      <th>st_teff</th>
      <th>st_rad</th>
      <th>st_mass</th>
      <th>disc_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10987</th>
      <td>PDS 70 b</td>
      <td>PDS 70</td>
      <td>Imaging</td>
      <td>10.331110</td>
      <td>30.488480</td>
      <td>953.49000</td>
      <td>3972.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2018.0</td>
    </tr>
    <tr>
      <th>11018</th>
      <td>Kepler-1517 b</td>
      <td>Kepler-1517</td>
      <td>Transit</td>
      <td>5.546084</td>
      <td>20.240000</td>
      <td>192.30249</td>
      <td>7358.0</td>
      <td>4.037000</td>
      <td>2.054</td>
      <td>2016.0</td>
    </tr>
    <tr>
      <th>11187</th>
      <td>Kepler-1698 b</td>
      <td>Kepler-1698</td>
      <td>Transit</td>
      <td>1.210693</td>
      <td>180.720000</td>
      <td>192.30249</td>
      <td>5019.0</td>
      <td>0.747000</td>
      <td>0.717</td>
      <td>2020.0</td>
    </tr>
    <tr>
      <th>11429</th>
      <td>Kepler-359 d</td>
      <td>Kepler-359</td>
      <td>Transit</td>
      <td>77.085964</td>
      <td>30.340000</td>
      <td>192.30249</td>
      <td>6210.0</td>
      <td>1.033000</td>
      <td>1.093</td>
      <td>2014.0</td>
    </tr>
    <tr>
      <th>11892</th>
      <td>Kepler-24 e</td>
      <td>Kepler-24</td>
      <td>Transit</td>
      <td>10.331110</td>
      <td>38.671000</td>
      <td>192.30249</td>
      <td>6022.0</td>
      <td>1.111000</td>
      <td>NaN</td>
      <td>2014.0</td>
    </tr>
    <tr>
      <th>12180</th>
      <td>Kepler-141 c</td>
      <td>Kepler-141</td>
      <td>Transit</td>
      <td>7.010627</td>
      <td>38.600000</td>
      <td>192.30249</td>
      <td>4173.0</td>
      <td>18.939000</td>
      <td>0.941</td>
      <td>2014.0</td>
    </tr>
    <tr>
      <th>12686</th>
      <td>Wendelstein-2 b</td>
      <td>Wendelstein-2</td>
      <td>Transit</td>
      <td>1.752217</td>
      <td>20.317766</td>
      <td>192.30249</td>
      <td>4355.0</td>
      <td>0.740712</td>
      <td>NaN</td>
      <td>2020.0</td>
    </tr>
    <tr>
      <th>12795</th>
      <td>BD-14 3065 b</td>
      <td>BD-14 3065 A</td>
      <td>Transit</td>
      <td>4.288973</td>
      <td>21.590000</td>
      <td>3932.00000</td>
      <td>6935.0</td>
      <td>2.350000</td>
      <td>1.410</td>
      <td>2024.0</td>
    </tr>
    <tr>
      <th>12801</th>
      <td>Kepler-435 b</td>
      <td>Kepler-435</td>
      <td>Transit</td>
      <td>8.600154</td>
      <td>22.310000</td>
      <td>266.97000</td>
      <td>6161.0</td>
      <td>3.210000</td>
      <td>1.538</td>
      <td>2015.0</td>
    </tr>
    <tr>
      <th>13108</th>
      <td>Kepler-1517 b</td>
      <td>Kepler-1517</td>
      <td>Transit</td>
      <td>5.546083</td>
      <td>22.270000</td>
      <td>192.30249</td>
      <td>7358.0</td>
      <td>4.037000</td>
      <td>2.054</td>
      <td>2016.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="exercise admonition" id="lectures/02-LimpiezayPrepDatos/DataCleaning-exercise-3">

<p class="admonition-title"><span class="caption-number">Exercise 3.4 </span> (Planet mass)</p>
<section id="exercise-content">
<ol class="arabic simple">
<li><p>Create a box plot for pl_bmasse. Remember to use a log scale (plt.xscale(‘log’)) to get a better view.</p></li>
<li><p>Based on the plot, choose a reasonable upper limit to filter out extreme outliers (for example, you might decide anything over 3000 Earth masses is an outlier worth investigating).</p></li>
<li><p>Filter the df_filtered DataFrame further to remove these mass outliers. Print the number of rows before and after to see how many planets you filtered.</p></li>
</ol>
</section>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="more-analysis">
<h3><span class="section-number">3.3.4. </span>More analysis<a class="headerlink" href="#more-analysis" title="Link to this heading">#</a></h3>
<p>Now let’s try to answer the following question: What is the most common discovery method for each decade?</p>
<p>To answer this, we need to make sure our <code class="docutils literal notranslate"><span class="pre">discoverymethod</span></code> and <code class="docutils literal notranslate"><span class="pre">disc_year</span></code> columns are clean and ready.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s check the different discovery methods</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unique Discovery Methods:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_filtered</span><span class="p">[</span><span class="s1">&#39;discoverymethod&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unique Discovery Methods:
discoverymethod
Transit                          35133
Radial Velocity                   2775
Microlensing                       775
Transit Timing Variations          159
Imaging                            156
Eclipse Timing Variations           26
Orbital Brightness Modulation       21
Pulsar Timing                       13
Astrometry                           6
Pulsation Timing Variations          2
Disk Kinematics                      1
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>The data looks clean. Now, let’s use our cleaned data to answer the question.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s create a &#39;decade&#39; column for easier grouping</span>
<span class="c1"># We can do this by integer division</span>
<span class="n">df_filtered</span><span class="p">[</span><span class="s1">&#39;discovery_decade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_filtered</span><span class="p">[</span><span class="s1">&#39;disc_year&#39;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>
<span class="n">df_filtered</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pl_name</th>
      <th>hostname</th>
      <th>discoverymethod</th>
      <th>pl_orbper</th>
      <th>pl_rade</th>
      <th>pl_bmasse</th>
      <th>st_teff</th>
      <th>st_rad</th>
      <th>st_mass</th>
      <th>disc_year</th>
      <th>discovery_decade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>HR 8799 d</td>
      <td>HR 8799</td>
      <td>Imaging</td>
      <td>37000.000000</td>
      <td>13.00</td>
      <td>3000.000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.500000</td>
      <td>2008.0</td>
      <td>2000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>HD 156279 b</td>
      <td>HD 156279</td>
      <td>Radial Velocity</td>
      <td>131.050000</td>
      <td>2.30</td>
      <td>3086.000</td>
      <td>5453.0</td>
      <td>NaN</td>
      <td>0.930000</td>
      <td>2011.0</td>
      <td>2010.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GJ 832 b</td>
      <td>GJ 832</td>
      <td>Radial Velocity</td>
      <td>3507.000000</td>
      <td>2.30</td>
      <td>197.046</td>
      <td>NaN</td>
      <td>0.441557</td>
      <td>0.437474</td>
      <td>2008.0</td>
      <td>2000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GJ 1214 b</td>
      <td>GJ 1214</td>
      <td>Transit</td>
      <td>1.580405</td>
      <td>2.27</td>
      <td>6.430</td>
      <td>NaN</td>
      <td>0.210000</td>
      <td>0.157000</td>
      <td>2009.0</td>
      <td>2000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>HD 24040 b</td>
      <td>HD 24040</td>
      <td>Radial Velocity</td>
      <td>3668.000000</td>
      <td>2.30</td>
      <td>1274.440</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.180000</td>
      <td>2006.0</td>
      <td>2000.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now, let&#39;s count the methods per decade</span>
<span class="n">discovery_summary</span> <span class="o">=</span> <span class="n">df_filtered</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;discovery_decade&#39;</span><span class="p">)[</span><span class="s1">&#39;discoverymethod&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Discovery Method Counts per Decade ---&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">discovery_summary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Discovery Method Counts per Decade ---
discovery_decade  discoverymethod              
1990.0            Radial Velocity                    174
                  Pulsar Timing                        8
2000.0            Radial Velocity                   1168
                  Transit                            726
                  Imaging                             41
                  Microlensing                        26
                  Eclipse Timing Variations            2
                  Pulsation Timing Variations          1
                  Pulsar Timing                        1
2010.0            Transit                          28815
                  Radial Velocity                    936
                  Microlensing                       261
                  Transit Timing Variations          129
                  Imaging                             69
                  Eclipse Timing Variations           20
                  Orbital Brightness Modulation       18
                  Pulsar Timing                        3
                  Pulsation Timing Variations          1
                  Disk Kinematics                      1
                  Astrometry                           1
2020.0            Transit                           5590
                  Radial Velocity                    497
                  Microlensing                       488
                  Imaging                             46
                  Transit Timing Variations           30
                  Astrometry                           5
                  Eclipse Timing Variations            4
                  Orbital Brightness Modulation        3
                  Pulsar Timing                        1
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="exercise admonition" id="lectures/02-LimpiezayPrepDatos/DataCleaning-exercise-4">

<p class="admonition-title"><span class="caption-number">Exercise 3.5 </span> (Visualizing the discovery data)</p>
<section id="exercise-content">
<ol class="arabic simple">
<li><p>The discovery_summary data is a Series. To plot it effectively with seaborn, it’s often easier to convert it into a DataFrame. Use the .reset_index() method on discovery_summary.</p></li>
<li><p>Rename the new column (which will likely be named count or 0) to something more descriptive, like planet_count.</p></li>
<li><p>Create a bar plot using seaborn.barplot() to show the planet_count for each discoverymethod, grouped by discovery_decade. Hint: Use x=‘discovery_decade’, y=‘planet_count’, and hue=‘discoverymethod’.</p></li>
<li><p>Give your plot a good title, like “Dominant Exoplanet Discovery Methods by Decade”.</p></li>
</ol>
</section>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># YOUR CODE HERE</span>
</pre></div>
</div>
</div>
</div>
<p>What can you conclude from your plot? Which method dominated the 2010s?</p>
</section>
<section id="more-about-pandas">
<h3><span class="section-number">3.3.5. </span>More about pandas<a class="headerlink" href="#more-about-pandas" title="Link to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Pandas</span></code> offers much more than what was shown here. Please check:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">apply</span></code>: to apply a function to a column. Example: make all pl_name lower: <code class="docutils literal notranslate"><span class="pre">df['pl_name'].apply(lambda</span> <span class="pre">x:</span> <span class="pre">x.lower())</span> </code></p></li>
<li><p>Operation across columns: <code class="docutils literal notranslate"><span class="pre">df['what</span> <span class="pre">is</span> <span class="pre">this']</span> <span class="pre">=</span> <span class="pre">df['pl_rade']</span> <span class="pre">+</span> <span class="pre">df['pl_orbper']</span></code></p></li>
<li><p>Concatenation: <code class="docutils literal notranslate"><span class="pre">concat</span></code></p></li>
<li><p>Merge: <code class="docutils literal notranslate"><span class="pre">merge</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">query</span></code>: <code class="docutils literal notranslate"><span class="pre">df.query('A</span> <span class="pre">&gt;</span> <span class="pre">B')</span></code>, <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html">https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">at</span></code>: <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.at.html">https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.at.html</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">where</span></code>: <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.where.html">https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.where.html</a></p></li>
<li><p>…</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "iluvatar1/ML4Sci-lectures",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lectures/02-LimpiezayPrepDatos"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../00-TALK-IntroML/IntroMachineLearning.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2. </span>A fast introduction to Machine Learning</p>
      </div>
    </a>
    <a class="right-next"
       href="../03-PCA/Intro-PCA.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>An Introduction to Principal Component Analysis (PCA)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-dataframe">3.1. The Dataframe</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-vs-polars">3.2. Pandas vs. Polars</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#polars-syntax-example">3.2.1. Polars Syntax Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applied-pandas-tutorial">3.3. Applied pandas tutorial</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-the-data">3.3.1. Getting the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-missing-values">3.3.2. Handling missing values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correcting-cosmic-anomalies-outliers">3.3.3. Correcting Cosmic Anomalies (Outliers)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-analysis">3.3.4. More analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#more-about-pandas">3.3.5. More about pandas</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By William Oquendo
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>